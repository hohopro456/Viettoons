<!DOCTYPE html>
<html style="background:#000;">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="referrer" content="no-referrer">
  <title>M3U8 Player</title>
  <script src="https://play.vlstream.net/jwplayer/jwplayer.js"></script>
  <script>jwplayer.key = "ITWMv7t88JGzI0xPwW8I0+LveiXX9SWbfdmt0ArUSyc=";</script>
  <style>
    body {
      margin: 0; background: #000; color: white;
      font-family: sans-serif;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      height: 100vh;
    }
    #inputForm {
      width: 90%; max-width: 500px;
      z-index: 10;
    }
    #inputForm input, #inputForm button {
      width: 100%; font-size: 18px; padding: 12px; margin-top: 10px;
    }

    #box, .loader {
      position: fixed !important;
      top: 0 !important; left: 0 !important;
      width: 100% !important; height: 100% !important;
      z-index: 1;
      display: none;
    }
	

    .loader {
      display: inline-block;
      border: 4px solid #FFF;
      border-bottom-color: transparent;
      border-radius: 50%;
      width: 57px; height: 57px;
      animation: rotation 1s linear infinite;
      top: calc(50% - 28px); left: calc(50% - 28px);
    }

    @keyframes rotation {
      0% { transform: rotate(0deg) }
      100% { transform: rotate(360deg) }
    }
  </style>
</head>
<body>

<div id="inputForm">
  <h2>Nhập link m3u8</h2>
  <input type="text" id="urlInput" placeholder="https://example.com/video.m3u8">
  <button onclick="submitUrl()">Xem</button>
</div>

<div class="loader"></div>
<div id="box"></div>

<script>
  function submitUrl() {
    const val = document.getElementById("urlInput").value.trim();
    if (val) {
      const newUrl = `${location.origin}${location.pathname}?url=${encodeURIComponent(val)}`;
      location.href = newUrl;
    }
  }

  const params = new URLSearchParams(location.search);
  if (params.has("url")) {
    // Ẩn form nhập
    document.getElementById("inputForm").style.display = "none";

    const file = decodeURIComponent(params.get("url"));
    const player = jwplayer("box");

    const opts = {
      sources: [{ file }],
      width: "100%",
      controls: true,
      autostart: false,
      mute: false,
      volume: 100,
      allowfullscreen: true,
      stretching: "uniform",
      primary: "html5",
      preload: "auto",
      aspectratio: "16:9",
      base: "."
    };

    player.setup(opts);

    player.on("ready", () => {
      document.querySelector("#box").style.display = "block";
      document.querySelector(".loader").style.display = "none";
    });
  }
</script>

</body>
</html>
